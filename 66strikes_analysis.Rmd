---
title: "Strikes in Steel Belt US Military Industry, 1966"
author: "Alex Trahan"
output:
  pdf_document: default
  html_document: default
date: "2024-10-10"
always_allow_html: yes
---
What effect did the Vietnam War have on labor relations within the US Military Industrial Complex?

From 1962 to 1965, the Labor Relations staff attached to US Army Mobility Command (MOCOM), based at the Detroit Tank Arsenal in Warren, Michigan, kept scattered, mostly handwritten records of the few dozen work stoppages that military contractors were required to report. Then, in 1966, strike activity inside military contractors plants exploded, producing enough reports - now standardized through a special form label DD-1507: Work Stoppage Report - to fill an entire US National Archives FRC box.

The picture found in DTA Labor Relations staff records stands in sharp contrast to existing official statistics on labor militancy in the defense industry.Under "Ordnance and accessories" (read: military industry), the Bureau of Labor Statistics (BLS) Work Stoppage Analysis for the year 1966 counts only thirteen strikes involving 8680 workers who idled for a total of 62,500 days. The documents analyzed in this data, which were generated by the Labor Relations staff at the Detroit Tank Arsenal (DTA) in that same year, tell a very different story: almost ten times as many strikes in military industrial plants, involving over five times as many workers, who cost their employers at least 790,000 worker-days. 

These DTA records provide only a partial scan of the whole body of military industry in the year 1966. DTA Labor Relations staff reporting on work stoppages focused almost exclusively on contracts overseen by the staff's parent agency, MOCOM. We rarely glimpse occurrences of labor unrest affecting contracts overseen by other Army commands, much less other branches of the US military. That said, MOCOM oversaw contracts for a number of big-ticket conventional hardware, like the M60 tank, the M109 self-propelled howitzer, and M110 armored personnel carrier, as well as many smaller but still important items, like trucks, shop vans, and the small horse-power engines used as generators to run AC in tropical Southeast Asia. This scan may be incomplete, but it captures vital organs of military industry, and its gaps merely point beyond itself to an even wider discrepancy between BLS data and the actual reality of shopfloor conflicts brought to boil by the intensification of US military involvement in the Vietnam War. The total number of strikes, strikers, and production days lost likely to be much higher than what is recorded in this document.

The stakes of this discrepancy between BLS data and DTA records are much deeper than simple accurate account; it matters for our understanding of how the United States' long, brutal, and industrially intense war in Southeast Asia shaped political-economic and social relations on its own soil. We know that the United States turned Southeast Asia into the most bombed region on the planet, dropping more bombs at a faster rate, than it used across all theatres of the Second World War. But we do not yet know enough about <em>how</em> all this materiel was made, <em>who</em> made it, and <em>what effects</em> its production had on social reality during a disavowed war with a disavowed home front. 

<em>*Nota Bene:* The purpose of this document is to serve as a heuristic for guiding research questions and in-depth qualitative investigation. It is neither a formal preview of a finished research project nor even a prospectus for a regimented quantitative analysis.



```{r setup, echo=FALSE, eval=FALSE, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```



```{r libraries, include=FALSE}

#set wd, library, import data

setwd("C:\\Users\\alex\\Dropbox\\DTA project\\coding\\66strikes") #for home

#setwd("C:\\Users\\atrahan\\Desktop\\coding\\66strikes") #for work


library(tidyverse)
library (knitr)
library (dplyr)
library(ggplot2)
library (tidyr) #for reshaping
library(stringr) #for strings
library(lubridate) #for dates
library(tidygeocoder) #for geocoding
library(leaflet) #for maps
library(leaflet.extras)
library(scales)  # Load the scales package for comma formatting
library(maps)  # For US state polygons
library(sp)    # For spatial data
library(htmlwidgets) #ditto
library(kableExtra)
library(tmaptools)
library(ggmap)
library(osmdata)


```



```{r wrangling, echo=FALSE, warning=FALSE}
#load strike data

strike <- read.csv("strike_geocoded.csv")

#wrangling the data

#remove qual notes, qual outcome, bad Days.Lost column
strike <- strike %>% 
  select(-Notes, -Days.Lost, -Outcome, -Cause, -Total.employees.at.location) %>%
  filter(!str_detect(Location, "Canada"))  # Keep rows where Location does not contain "Canada"

# Create 'city' and 'state' columns  from 'Location', then remove 'Location'
strike <- strike %>%
  mutate(state = str_extract(Location, "(?<=,\\s)[A-Za-z]+$")) %>% 
  mutate(city = str_extract(Location, "^[^,]+"))
  # this breaks maps right now. fix that later, then add: select(-Location)

# Replace blank observations with NA, but only for character columns
strike <- strike %>%
  mutate(across(where(is.character), ~ na_if(., "")))

#column renames
colnames(strike)[which(colnames(strike) == "Number.of.Employees.on.Strike")] <- "strikers"
colnames(strike)[which(colnames(strike) == "Company.Organization")] <- "company"

# Ensure 'Date.Started' and 'Date.Settled' are in date format, then create 'strike_length' [days] column
strike <- strike %>%
  mutate(
    Date.Started = parse_date_time(Date.Started, orders = c("mdy", "dmy", "ymd"), quiet = TRUE),
    Date.Settled = parse_date_time(Date.Settled, orders = c("mdy", "dmy", "ymd"), quiet = TRUE),
    strike_length = as.numeric(difftime(Date.Settled, Date.Started, units = "days")),
    strike_length = ifelse(strike_length == 0, 1, strike_length)  # Change 0 to 1. No strikes lasted 0 days, even if they began and ended on same day.
  )

#create column 'percent_lost' [percentage of productivity days lost] by dividing length of strike by days in the year
strike <- strike %>%
  mutate(percent_lost = (strike_length / 365) * 100)


# Add a new column 'worker_days_lost' by multiplying 'strike_length' by 'strikers'
strike <- strike %>%
  mutate(
    strike_length = as.numeric(strike_length),  # Convert 'strike_length' to numeric
    strikers = as.numeric(strikers),              # Convert 'strikers' to numeric
    worker_days_lost = strike_length * strikers   # Create 'worker_days_lost'
  )

#cleaning up "Type" column
strike <- strike %>%
  mutate(Type = tolower(Type)) %>%
  mutate(Type = ifelse(str_detect(Type, "potential"), "potential strike (averted)", Type)) %>%
  mutate(Type = ifelse(str_detect(Type, "wildcat"), "wildcat strike", Type)) %>%
  mutate(Type = if_else(str_detect(Type, "strike") & !str_detect(Type, "potential") & !str_detect(Type, 'wildcat'), "authorized strike", Type))

# Remove all spaces from observations in the 'Strikers' column
strike$strikers <- as.numeric(str_squish(strike$strikers))

#remove canada and years other than 1966

strike <- strike %>%
  filter(Date.Started >= as.Date("1966-01-01"))  # Keep rows where Date.Started is on or after January 1, 1966


```
\newpage
# BLS Data for 1966

```{r bls, echo=FALSE, out.width='100%', fig.cap="BLS Work Stoppages Analyis, 1966 (p. 9)"}
knitr::include_graphics("bls.png")


```
\newpage
# Summary Statistics DTA Labor Relations Records, 1966

```{r, include=FALSE, echo=FALSE}

#THIS TABLE EXCLUDED FOR READABILITY

# Create a summary table
kable(total_summary <- strike %>%
  summarise(
    Total_Events = n(),                      # Count total number of events (strikes)
    Total_Workers = sum(strikers, na.rm = TRUE)  # Sum total workers involved
  ), caption="Total Events and Total Workers Involved") 

```


```{r,summary_stats, echo=FALSE}
# Count observations in the 'Type' column
type_counts <- strike %>%
  group_by(Type) %>%                # Group by 'Type'
  summarise(count = n(),           # Count the number of occurrences
            .groups = "drop")      # Drop grouping after summarizing

# Print the resulting table
kable(type_counts, caption = "Strike events by type")


# Filter the strike dataframe to exclude rows where 'Type' is exactly 'potential'
strike_filtered <- strike %>%
  filter(Type != "potential strike (averted)")  # Exclude rows with 'Type' equal to 'potential'

# Create a summary table with total strikes, total strikers, total strike length, and total hours lost
strike_summary <- strike_filtered %>%
  summarise(
    total_strikes = comma(n()),                        
    total_strikers = comma(sum(strikers, na.rm = TRUE)), 
    worker_days_lost = comma(sum(worker_days_lost,na.rm = TRUE))
  ) %>%
  rename("Total Strikes" = total_strikes, "Total Strikers" = total_strikers, "Worker-Days Lost" = worker_days_lost)

# Print the table
kable(t(strike_summary), caption = "Summary stats for Actual Strikes (Authorized + Wildcat)")


# Summary stats
strikers_summary <- strike_filtered %>%
  summarise(
    "Minimum Strikers" = round(min(strikers, na.rm = TRUE)),
    "Maximum Strikers" = round(max(strikers, na.rm = TRUE)),
    "Mean Strikers" = round(mean(strikers, na.rm = TRUE)),
    "Median Strikers" = round(median(strikers, na.rm = TRUE)),
    "Standard Deviation" = round(sd(strikers, na.rm = TRUE))
  )

length_summary <- strike_filtered %>%
  summarise(
    "Mean Strike Length" = round(mean(strike_length, na.rm = TRUE)),
    "Median Length" = round(median(strike_length, na.rm = TRUE)),
    "Minimum Strike Length" = round(min(strike_length, na.rm = TRUE)),   
    "Maximum Strike Length" = round(max(strike_length, na.rm = TRUE))
  )

worker_day_summary <- strike_filtered %>%
  summarise(
    "Minimum Worker-Days Lost" = round(min(worker_days_lost, na.rm = TRUE)),
    "Maximum Worker-Days Lost" = round(max(worker_days_lost, na.rm = TRUE)),
    "Mean Worker-Days Lost" = round(mean(worker_days_lost, na.rm = TRUE)),
    "Median Worker-Days Lost" = round(median(worker_days_lost, na.rm = TRUE)),
    "Average Percentage of Worker-Time Lost" = round(mean(percent_lost, na.rm=TRUE))
  )

kable(t(strikers_summary), caption = "Workers on Strike")
kable(t(length_summary), caption="Strike Length")
kable(t(worker_day_summary), caption="Work-Days Lost")
```


```{r, echo=FALSE}

# Calculate percentage of time lost and print table STILL WORKING ON THIS

total_percentage_lost <- strike_filtered %>%
  filter(!is.na(strike_length)) %>%  # Step 1: Filter out NAs
  summarise(
    total_strike_length = sum(strike_length, na.rm = TRUE)  # Sum of strike_length
  ) %>%
  mutate(
    total_rows = nrow(strike_filtered),  # Count of rows in the original filtered data
    percent_lost = (total_strike_length / (total_rows * 365)) * 100  # Calculate percentage
  ) %>%
  pull(percent_lost)

kable(t(total_percentage_lost),caption="Estimated Percentage of Production Time Lost by Military Contractors in Data")


```

How the above value is calculated: ( (sum of days lost to all strikes) / [(sum of all contractors) * 365)] )*100. This slightly over estimates percentage of productivity days lost because it double counts a small number of factories that featured multiple strikes and assumes that every factory operated 365 days a year.


<br>
<br>

# Strikes and Strikers Over Time

<br>


```{r strikes_by_month, echo=FALSE}
# Create a new data frame summarizing strikes by month
monthly_strikes <- strike_filtered %>%
  mutate(Month = month(Date.Started, label = TRUE, abbr = TRUE)) %>%  # Extract month names
  group_by(Month) %>%                                                 # Group by month
  summarise(`Total Strikes` = n(),                                   # Count total strikes
            `Total Strikers` = sum(strikers, na.rm = TRUE),        # Sum total strikers
            .groups = "drop")                                       # Drop grouping after summarising

# Flip the orientation of the table
monthly_strikes_wide <- monthly_strikes %>%
  pivot_longer(cols = `Total Strikes`:`Total Strikers`,             # Pivot longer for two rows
               names_to = "Metric",                                  # Create a new column for metric names
               values_to = "Count")                               # Create a new column for values

# Reshape into wide format
monthly_summary <- monthly_strikes_wide %>%
  pivot_wider(names_from = Month, values_from = Count)             # Pivot wider to get months as columns

# Print the resulting table
kable(monthly_summary, caption = "Total Strikes and Total Strikers by Month, 1966")
```



```{r time_graph, echo=FALSE}
strike_ongoing <- strike %>%
  filter(!is.na(Date.Started) & !is.na(Date.Settled)) %>%
  mutate(Date = map2(Date.Started, Date.Settled, seq, by = "day")) %>%
  unnest(Date) %>%
  group_by(Date) %>%
  summarise(ongoing_strikes = n())

# Create a line graph of ongoing strikes
ggplot(strike_ongoing, aes(x = Date, y = ongoing_strikes)) +
  geom_line(color = "steelblue") +
  geom_smooth(method = "loess", color = "red", se = FALSE) +
  labs(title = "Total Ongoing Strikes by Day",
       x = "Date",
       y = "Number of Ongoing Strikes") +
  theme_minimal() 


strikers_daily <- strike %>%
  filter(!is.na(Date.Started) & !is.na(Date.Settled)) %>%
  mutate(Date = map2(Date.Started, Date.Settled, seq, by = "day")) %>%
  unnest(Date) %>%
  group_by(Date) %>%
  summarise(total_strikers = sum(strikers, na.rm = TRUE))

ggplot(strikers_daily, aes(x = Date, y = total_strikers)) +
  geom_line(color = "steelblue") +
  geom_smooth(method="loess",color="red",se=FALSE)+
  labs(title = "Total Strikers Day-by-Day, 1966",
       x = "Date",
       y = "Total Strikers") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))


```

\newpage

# Geography of Military Industry Strikes in DTA Records, 1966

<br>

#### Two of the following maps have interactive features when viewed as stand-alone HTML documents. Click on a marker to reveal specific information about a strike. Please note, these interactive functions are not available when the maps are viewed as part of the larger document.

```{r create_maps, echo=FALSE, warning=FALSE}
# Create a state-level summary of strikers
state_strike_summary <- strike %>%
  #filter(!is.na(strikers)) %>% #this drops too many states
  mutate(State = str_extract(Location, paste(state.name, collapse = "|"))) %>%
  group_by(State) %>%
  summarise(total_strikers = sum(strikers, na.rm = TRUE)) %>%
  drop_na()  # Drop any rows with missing state

# Get US state polygons
states <- map("state", fill = TRUE, plot = FALSE)

# Create a mapping of state names to maps package names
state_mapping <- data.frame(
  original = c("Michigan", "New York", "Washington"),
  maps_name = c("michigan:south", "new york:main", "washington:main"),
  stringsAsFactors = FALSE
)

# Replace state names in state_strike_summary with maps package names
state_strike_summary <- state_strike_summary %>%
  left_join(state_mapping, by = c("State" = "original")) %>%
  mutate(State = ifelse(is.na(maps_name), State, maps_name)) %>%
  select(-maps_name)  # Drop the temporary maps_name column

# Ensure state names in the summary are lowercase to match map data
state_strike_summary <- state_strike_summary %>%
  mutate(State = tolower(State))

# Match state data to polygons
state_match <- match(tolower(states$names), state_strike_summary$State)

# Add the total strikers to the state polygons
states$values <- state_strike_summary$total_strikers[state_match]

# Define a color palette
pal <- colorNumeric(
  palette = "YlOrRd",
  domain = state_strike_summary$total_strikers,  # Use total strikers for color domain
  na.color = "transparent"  # Set missing values to transparent
)

# Create the leaflet map
map1 <- leaflet(states) %>%
  addTiles() %>%
  addPolygons(
    fillColor = ~pal(values),
    fillOpacity = 0.7,
    color = "white",  # Border color
    weight = 1,       # Border thickness
    highlight = highlightOptions(
      weight = 2,
      color = "#666",
      fillOpacity = 0.9
    ),
    label = ~paste0(states$names, ": ", values, " strikers"),  # State name and number of strikers on hover
    labelOptions = labelOptions(
      style = list("font-weight" = "normal", padding = "3px 8px"),
      textsize = "15px",
      direction = "auto"
    )
  ) %>%
  addLegend(
    pal = pal,
    values = state_strike_summary$total_strikers,
    opacity = 0.7,
    title = "Number of Strikers by State",
    position = "bottomright"
  )

strike_clean <- strike %>%
  filter(!is.na(longitude) & !is.na(latitude) )  # Filter out rows with NA

# Create an interactive leaflet map
map2<-leaflet(data = strike_clean) %>%
  addTiles() %>%
  addCircleMarkers(~longitude, ~latitude, popup = ~paste("City:", Location, "<br>",
                                                         "Company:" , company, "<br>",
                                                         "Type:" , Type, "<br>",
                                                         "Strikers:", strikers, "<br>",
                                                         "Length:", strike_length, "days"),
                   radius = 5, color = "red", stroke = FALSE, fillOpacity = 0.5)%>%
  addLegend("bottomright", pal = colorFactor("red", domain = NULL), values = NULL, title = "US Military Industry Strikes, 1966")

#create interactive rust belt map


# Define the states of interest
steel_belt <- c("Wisconsin", "Illinois", "Indiana", "Michigan", "Ohio", "Pennsylvania", "New York")

# Filter the strike data for the specified states
filtered_strike <- strike %>%
  filter(str_detect(Location, paste(steel_belt, collapse = "|")))

# Create a leaflet map for the specified states
map3<-leaflet(data = filtered_strike) %>%
  addTiles() %>%  # Add OpenStreetMap tiles
  setView(lng = -84, lat = 41, zoom = 6) %>%  # Center the map on the Midwest region
  addCircleMarkers(~longitude, ~latitude, popup = ~paste("City:", Location, "<br>",
                                                         "Union Local", Union.Local,"<br>",
                                                         "Company:" , company, "<br>",
                                                         "Type:" , Type, "<br>",
                                                         "Strikers:", strikers, "<br>",
                                                         "Start Date",Date.Started,"<br>",
                                                         "Date Settled",Date.Settled,"<br>",
                                                         "Length:", strike_length, "days"),
                   radius = 5, color = "red", stroke = FALSE, fillOpacity = 0.5) %>%
  addLegend("bottomright", pal = colorFactor("red", domain = NULL), values = NULL, title = "US Military Industry Strikes in the Steel Belt, 1966")

# Save maps as html for printing to pdf
saveWidget(map1, file="map1.html")
saveWidget(map2, file="map2.html")
saveWidget(map3, file="map3.html")

```


```{r print maps html, include=FALSE, echo=FALSE, eval=knitr::opts_knit$get("rmarkdown.pandoc.to")=="html"}

map1

#state table
kable(
  strike %>%
    filter(!is.na(state)) %>%  
    group_by(state) %>%
    summarise(frequency = n(), .groups = "drop") %>%
    arrange(desc(frequency)),
  caption="States by frequency"
)

map2

map3



```

```{r map 1 PDF, echo=FALSE}

  
# Include the PNGs in the PDF
webshot::webshot("map1.html", "map1.png")


```
\newpage
```{r state table pdf, echo=FALSE}

#state table
kable(
  strike %>%
    filter(!is.na(state)) %>%  
    group_by(state) %>%
    summarise(frequency = n(), .groups = "drop") %>%
    arrange(desc(frequency)),
  caption="States by frequency"
)
```
\newpage
```{r maps 2 and 3 PDF, echo=FALSE}

#2 and 3 for pdf
webshot::webshot("map2.html", "map2.png")
webshot::webshot("map3.html", "map3.png")

```
\newpage

# What cities are in the data?

```{r cities, echo=FALSE}
# Create a frequency table for city occurrences and strikers, along with summary
summary_tables <- strike_filtered %>%
  filter(!is.na(Location)) %>%
  group_by(Location) %>%
  summarize(
    Strikes = n(),                           # Count the number of strikes
    Total_Strikers = sum(strikers, na.rm = TRUE)  # Sum the total strikers
  ) %>%
  arrange(desc(Strikes))                    # Arrange by number of strikes in descending order

# Rename columns for clarity in summary_tables
colnames(summary_tables) <- c("City", "Number of Strikes", "Total Strikers")

# Count the frequency of unique values in the "Number of Strikes" column
strike_distribution <- summary_tables %>%
  count(`Number of Strikes`) %>%
  arrange(desc(`Number of Strikes`))  # Arrange in descending order for better visibility

# Rename columns for clarity in strike_distribution
colnames(strike_distribution) <- c("Number of Strikes", "Frequency")

# Split into separate tables
top_cities <- summary_tables %>%
  slice_head(n = 5)                          # Get the top 5 cities by strikes

top_cities_strikers <- summary_tables %>%
  arrange(desc("Total Strikers")) %>%
  slice_head(n = 5)                          # Get the top 5 cities by strikers


# Display the frequency tables
kable(top_cities, caption = "Top 5 Cities by Frequency of Strikes")
kable(top_cities_strikers, caption = "Top 5 Cities by Striking Employees")
kable(strike_distribution, caption = "Frequency Distribution of Number of Strikes")
kable(summary_tables, caption = "All Cities, Arranged by Number of Strikes")

```


* Note: A value of 0 indicates that a strike occurred by DTA labor relations staff did not record the total number of employees involved in a work stoppage


### To Do:

* continue cleaning up data manually
* clean up cities
* clean up state column



